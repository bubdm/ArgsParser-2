# ArgsParser

Easy argument parsing for .Net Core applications.

Available as [a nuget package](https://www.nuget.org/packages/ArgsParser/).

## Example usage

``` csharp
using ArgsParser;

// other code

var parser = new Parser(args)
    .SupportsOption<int>("port", "Port to start the dev server on", 1337)
    .RequiresOption<string>("read", "Folder to read the site from", "site")
    .RequiresOption<string>("write", "Folder to write the result to")
    .SupportsFlag("serve", "Start the site going in a dev server")
    .SupportsFlag("force", "Overwrite any destination content")
    .Help();

parser.Parse();

var hasError = parser.HasErrors;
var serve = parser.IsFlagProvided("serve");
var port = parser.GetOption<int>("port");
var read = parser.GetOption<string>("read");
```

### Example autogenerated help info (`.Help()`)

Required options come first, then optional options, then flags.
Each of those three blocks is further sorted alphabetically.

``` text
-read  <value>   Folder to read the site from (required)
-write <value>   Folder to write the result to (required)
-port  <value>   Port to start the dev server on

-force           Overwrite any destination content
-serve           Start the site going in a dev server
```

### Example input

``` batch
mycommand -run data "Site Title" --serve -ignore -port 3000
```

### Example errors from the above

Errors come in two collections. The property `HasErrors` will be `true` if either collection has entries.

- `ExpectationErrors` are where expectations are not met by the arguments provided (eg missing required option)
- `ArgumentErrors` are where something was provided but there were issues with it (eg a value without an option)

For example, with the coniguration above and the example input shown the combined errors will be as below.
The first is an expectation error and is keyed by the name of the option.
The remaining three are argument errors keyed by their 0-based offset into the args provided.
Notice that the "missing" `read` option has no error. This is because it was defined above with a default value.

``` text
write => Option missing: write
0 => Unknown option: run
2 = Unexpected value: Site Title
4 => Unknown flag: ignore
```

## Supported

- Display help showing supported flags/options
- Required named option/values
- Optional named option/values
- Optional named flags
- Parsing generates simple collections
  - A collection of all provided options (keys and their typed values)
  - A collection of all provided flags (array of named)
- Provides a collection of error messages
	- Missing required options
	- Unknown flags or options
	- Values not attached to options
- Option types support any `IConvertable`, including `int`, `bool`, `DateTime`
- Accepts either `-` or `--` prefixes

## The example in detail

``` csharp
var args = new string[] { "-run", "data", "Site Title", "--serve", "-ignore", "-port", "3000" };

var parser = new Parser(args)
    .SupportsOption<int>("port", "Port to start the dev server on", 1337)
    .RequiresOption<string>("read", "Folder to read the site from", "site")
    .RequiresOption<string>("write", "Folder to write the result to")
    .SupportsFlag("serve", "Start the site going in a dev server")
    .SupportsFlag("force", "Overwrite any destination content")
    .Help();

var result = parser.Parse();

Assert.AreEqual(4, result.ExpectationErrors.Count + result.ArgumentErrors.Count);
Assert.Contains("Option missing: write", result.ExpectationErrors.Values.ToList());
Assert.Contains("Unknown option: run", result.ArgumentErrors.Values.ToList());
Assert.Contains("Unexpected value: Site Title", result.ArgumentErrors.Values.ToList());
Assert.Contains("Unknown flag: ignore", result.ArgumentErrors.Values.ToList());

Assert.IsTrue(result.IsOptionProvided("port"));
Assert.AreEqual(3000, result.GetOption<int>("port"));

Assert.IsTrue(result.IsOptionProvided("read"));
Assert.AreEqual("site", result.GetOption<string>("read"));

Assert.IsFalse(result.IsOptionProvided("write"));
Assert.AreEqual(null, result.GetOption<string>("write"));

Assert.IsTrue(result.IsFlagProvided("serve"));
Assert.IsFalse(result.IsFlagProvided("force"));
```

Copyright K Cartlidge 2020.
Licensed as [GNU AGPLv3](./LICENSE).

See the [CHANGELOG](./CHANGELOG.md) for current status.
